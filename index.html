<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Reskin : Android换肤库">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Reskin</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/SethFeng/Reskin">View on GitHub</a>

          <h1 id="project_title">Reskin</h1>
          <h2 id="project_tagline">Android换肤库</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/SethFeng/Reskin/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/SethFeng/Reskin/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="使用步骤" class="anchor" href="#%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>使用步骤</h3>

<ol>
<li>在应用Application <code>onCreate()</code>里添加：</li>
</ol>

<div class="highlight highlight-source-java"><pre><span class="pl-smi">SkinManager</span><span class="pl-k">.</span>init(<span class="pl-v">this</span>);</pre></div>

<ol>
<li>支持换肤功能的Activity继承<code>BaseActivity</code>
</li>
</ol>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MainActivity</span> <span class="pl-k">extends</span> <span class="pl-e">BaseActivity</span> {
    <span class="pl-c1">...</span>
}</pre></div>

<ol>
<li>手动add的系统View，需要将View及其换肤属性添加到换肤管理</li>
</ol>

<div class="highlight highlight-source-java"><pre><span class="pl-c">/** 动态添加系统View */</span>
<span class="pl-smi">LinearLayout</span> linearLayout <span class="pl-k">=</span> (<span class="pl-smi">LinearLayout</span>) findViewById(<span class="pl-smi">R</span><span class="pl-k">.</span>id<span class="pl-k">.</span>root);
<span class="pl-smi">TextView</span> tv <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">TextView</span>(<span class="pl-v">this</span>);
<span class="pl-k">int</span> colorResId <span class="pl-k">=</span> <span class="pl-smi">R</span><span class="pl-k">.</span>color<span class="pl-k">.</span>textColor;
tv<span class="pl-k">.</span>setTextColor(getResources()<span class="pl-k">.</span>getColor(colorResId));
linearLayout<span class="pl-k">.</span>addView(tv);

<span class="pl-c">/** 动态添加系统View不走onCreateView,需要手动添加换肤关注属性 */</span>
<span class="pl-k">List&lt;<span class="pl-smi">DynamicViewAttribute</span>&gt;</span> attrs <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">ArrayList&lt;&gt;</span>();
attrs<span class="pl-k">.</span>add(<span class="pl-k">new</span> <span class="pl-smi">DynamicViewAttribute</span>(<span class="pl-s"><span class="pl-pds">"</span>textColor<span class="pl-pds">"</span></span>, colorResId));
addSkinView(tv, attrs);</pre></div>

<ol>
<li>自定义View</li>
</ol>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SkinnableView</span> <span class="pl-k">extends</span> <span class="pl-e">CustomSkinView</span> {

    <span class="pl-k">private</span> <span class="pl-smi">String</span> mText;

    <span class="pl-k">public</span> <span class="pl-en">SkinnableView</span>(<span class="pl-smi">Context</span> <span class="pl-v">context</span>) {
        <span class="pl-v">super</span>(context);
    }

    <span class="pl-k">public</span> <span class="pl-en">SkinnableView</span>(<span class="pl-smi">Context</span> <span class="pl-v">context</span>, <span class="pl-smi">AttributeSet</span> <span class="pl-v">attrs</span>) {
        <span class="pl-v">super</span>(context, attrs);
    }

    <span class="pl-k">public</span> <span class="pl-en">SkinnableView</span>(<span class="pl-smi">Context</span> <span class="pl-v">context</span>, <span class="pl-smi">AttributeSet</span> <span class="pl-v">attrs</span>, <span class="pl-k">int</span> <span class="pl-v">defStyleAttr</span>) {
        <span class="pl-v">super</span>(context, attrs, defStyleAttr);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">initSKinRes</span>() {
        <span class="pl-c">/** 赋值:系统默认值 */</span>
        mText <span class="pl-k">=</span> getResources()<span class="pl-k">.</span>getString(<span class="pl-smi">R</span><span class="pl-k">.</span>string<span class="pl-k">.</span>demo_text);

        <span class="pl-c">/** 若当前主题不是默认主题,需要更改属性值 */</span>
        <span class="pl-k">if</span> (<span class="pl-smi">SkinManager</span><span class="pl-k">.</span>getTheme() <span class="pl-k">!=</span> <span class="pl-smi">SkinTheme</span><span class="pl-c1"><span class="pl-k">.</span>DEFAULT</span>) {
            <span class="pl-k">try</span> {
                mText <span class="pl-k">=</span> getResources()<span class="pl-k">.</span>getString(<span class="pl-smi">SkinManager</span><span class="pl-k">.</span>getTheme()<span class="pl-k">.</span>getId(<span class="pl-smi">R</span><span class="pl-k">.</span>string<span class="pl-k">.</span>demo_text));
            } <span class="pl-k">catch</span> (<span class="pl-smi">Resources</span><span class="pl-k">.</span><span class="pl-smi">NotFoundException</span> e) {
            }
        }
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">protected</span> <span class="pl-k">void</span> <span class="pl-en">onLayout</span>(<span class="pl-k">boolean</span> <span class="pl-v">changed</span>, <span class="pl-k">int</span> <span class="pl-v">left</span>, <span class="pl-k">int</span> <span class="pl-v">top</span>, <span class="pl-k">int</span> <span class="pl-v">right</span>, <span class="pl-k">int</span> <span class="pl-v">bottom</span>) {
        <span class="pl-c1">...</span>
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">protected</span> <span class="pl-k">void</span> <span class="pl-en">onDraw</span>(<span class="pl-smi">Canvas</span> <span class="pl-v">canvas</span>) {
        <span class="pl-v">super</span><span class="pl-k">.</span>onDraw(canvas);
        canvas<span class="pl-k">.</span>drawText(mText, <span class="pl-c1">...</span>);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">reSkin</span>(<span class="pl-smi">SkinTheme</span> <span class="pl-v">theme</span>) {
        <span class="pl-c">/** 必须try catch资源找不到时的异常，异常可不处理 */</span>
        <span class="pl-k">try</span> {
            mText <span class="pl-k">=</span> getResources()<span class="pl-k">.</span>getString(theme<span class="pl-k">.</span>getId(<span class="pl-smi">R</span><span class="pl-k">.</span>string<span class="pl-k">.</span>demo_text));
        } <span class="pl-k">catch</span> (<span class="pl-smi">Resources</span><span class="pl-k">.</span><span class="pl-smi">NotFoundException</span> e) {
        }

        <span class="pl-c">/** 更改属性值后刷新View */</span>
        invalidate();
    }
}</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Reskin maintained by <a href="https://github.com/SethFeng">SethFeng</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
